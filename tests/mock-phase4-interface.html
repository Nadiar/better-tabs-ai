<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better Tabs AI - Phase 4 Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 2rem; }

        .group-container { background: white; border: 2px solid #e2e8f0; border-left: 4px solid #667eea; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; max-width: 600px; }
        .group-header { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem; background: rgba(102, 126, 234, 0.1); border-radius: 4px; margin-bottom: 0.5rem; }
        .group-title-section { display: flex; align-items: center; gap: 0.5rem; flex: 1; }

        .color-swatch-container { position: relative; }
        .color-swatch { width: 20px; height: 20px; border-radius: 4px; border: 2px solid rgba(0, 0, 0, 0.1); cursor: pointer; transition: all 0.2s; }
        .color-swatch:hover { transform: scale(1.1); }

        .color-picker-dropdown { position: absolute; top: 100%; left: 0; margin-top: 0.25rem; background: white; border: 1px solid #e2e8f0; border-radius: 8px; box-shadow: 0 10px 15px rgba(0,0,0,0.1); padding: 0.5rem; display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; z-index: 1000; }
        .color-picker-dropdown.hidden { display: none; }

        .color-option { width: 28px; height: 28px; border-radius: 4px; border: 2px solid rgba(0, 0, 0, 0.1); cursor: pointer; transition: all 0.2s; }
        .color-option:hover { transform: scale(1.1); border-color: rgba(0, 0, 0, 0.3); }
        .color-option.active { border-color: #1e293b; border-width: 3px; box-shadow: 0 0 0 2px white, 0 0 0 4px #1e293b; }

        .group-title { font-size: 0.875rem; font-weight: 600; cursor: pointer; user-select: none; }
        .group-title-input { font-size: 0.875rem; font-weight: 600; border: 2px solid #667eea; border-radius: 4px; padding: 0.25rem 0.5rem; outline: none; min-width: 150px; }

        .ai-name-btn { background: transparent; border: none; font-size: 1rem; padding: 0.25rem; opacity: 0.7; cursor: pointer; transition: all 0.2s; }
        .ai-name-btn:hover:not(:disabled) { opacity: 1; transform: scale(1.1); background: rgba(102, 126, 234, 0.1); border-radius: 4px; }
        .ai-name-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .group-actions { display: flex; align-items: center; gap: 0.5rem; }
        .tab-count { font-size: 0.75rem; color: #64748b; background: #f1f5f9; padding: 0.25rem 0.5rem; border-radius: 10px; font-weight: 600; }
        .delete-group { background: transparent; border: none; font-size: 1.5rem; color: #ef4444; opacity: 0.6; cursor: pointer; transition: all 0.2s; padding: 0.25rem; }
        .delete-group:hover { opacity: 1; background: rgba(239, 68, 68, 0.1); border-radius: 4px; }

        .group-tabs { padding: 0.5rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.4rem; }
        .tab-card { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 0.5rem; font-size: 0.875rem; }

        .toast-container { position: fixed; bottom: 2rem; right: 2rem; z-index: 1000; display: flex; flex-direction: column; gap: 0.75rem; max-width: 400px; }
        .toast { background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 10px 15px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 0.75rem; animation: toast-slide-in 0.3s ease; }
        .toast-success { border-left: 4px solid #10b981; }
        .toast-info { border-left: 4px solid #3b82f6; }

        @keyframes toast-slide-in {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .stats { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; max-width: 600px; }
        .stats h3 { margin-bottom: 0.5rem; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 0.5rem; }
        .stat-item { text-align: center; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: #667eea; }
        .stat-label { font-size: 0.75rem; color: #64748b; margin-top: 0.25rem; }
    </style>
</head>
<body>
    <h1>Phase 4: Group Management Test</h1>
    <p style="margin: 1rem 0; color: #64748b;">Testing AI name generation, color picker, and delete functionality</p>

    <div class="stats" id="stats">
        <h3>Performance Metrics</h3>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-value" id="colorPickerTime">-</div>
                <div class="stat-label">Color Picker (ms)</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="aiNameTime">-</div>
                <div class="stat-label">AI Name Gen (ms)</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="deleteTime">-</div>
                <div class="stat-label">Delete (ms)</div>
            </div>
        </div>
    </div>

    <div class="group-container" id="testGroup" data-group-id="1">
        <div class="group-header">
            <div class="group-title-section">
                <!-- Color Swatch -->
                <div class="color-swatch-container">
                    <button class="color-swatch" id="colorSwatch" style="background-color: #667eea;"></button>
                    <div class="color-picker-dropdown hidden" id="colorPicker">
                        <button class="color-option" data-color="grey" style="background-color: #5f6368;"></button>
                        <button class="color-option active" data-color="blue" style="background-color: #1a73e8;"></button>
                        <button class="color-option" data-color="red" style="background-color: #d93025;"></button>
                        <button class="color-option" data-color="yellow" style="background-color: #f9ab00;"></button>
                        <button class="color-option" data-color="green" style="background-color: #1e8e3e;"></button>
                        <button class="color-option" data-color="pink" style="background-color: #d01884;"></button>
                        <button class="color-option" data-color="purple" style="background-color: #9334e6;"></button>
                        <button class="color-option" data-color="cyan" style="background-color: #007b83;"></button>
                    </div>
                </div>

                <!-- Title (editable) -->
                <span class="group-title" id="groupTitle">Development Tools</span>
                <input class="group-title-input hidden" id="groupTitleInput" value="Development Tools" maxlength="50" />

                <!-- AI Name Generation -->
                <button class="ai-name-btn" id="aiNameBtn" title="Generate AI name">✨</button>
            </div>

            <div class="group-actions">
                <span class="tab-count" id="tabCount">5</span>
                <button class="delete-group" id="deleteBtn" title="Delete group">×</button>
            </div>
        </div>

        <div class="group-tabs" id="groupTabs">
            <div class="tab-card">GitHub</div>
            <div class="tab-card">VS Code</div>
            <div class="tab-card">Stack Overflow</div>
            <div class="tab-card">MDN Docs</div>
            <div class="tab-card">React Docs</div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <script>
        const colorMap = {
            grey: '#5f6368', blue: '#1a73e8', red: '#d93025', yellow: '#f9ab00',
            green: '#1e8e3e', pink: '#d01884', purple: '#9334e6', cyan: '#007b83'
        };

        let currentColor = 'blue';
        let toastId = 0;

        // Color Picker
        const colorSwatch = document.getElementById('colorSwatch');
        const colorPicker = document.getElementById('colorPicker');
        const colorOptions = document.querySelectorAll('.color-option');

        colorSwatch.addEventListener('click', () => {
            const startTime = performance.now();
            colorPicker.classList.toggle('hidden');
            const endTime = performance.now();
            document.getElementById('colorPickerTime').textContent = (endTime - startTime).toFixed(2);
            console.log('Color picker toggled:', !colorPicker.classList.contains('hidden'));
        });

        colorOptions.forEach(option => {
            option.addEventListener('click', (e) => {
                const color = e.target.getAttribute('data-color');
                const colorValue = colorMap[color];

                // Update swatch
                colorSwatch.style.backgroundColor = colorValue;

                // Update active state
                colorOptions.forEach(opt => opt.classList.remove('active'));
                e.target.classList.add('active');

                // Update group border
                document.getElementById('testGroup').style.borderLeftColor = colorValue;

                // Close picker
                colorPicker.classList.add('hidden');

                currentColor = color;
                addToast(`Color changed to ${color}`, 'success');
                console.log('Color changed to:', color);
            });
        });

        // Inline Title Editing
        const groupTitle = document.getElementById('groupTitle');
        const groupTitleInput = document.getElementById('groupTitleInput');

        groupTitle.addEventListener('click', () => {
            groupTitle.classList.add('hidden');
            groupTitleInput.classList.remove('hidden');
            groupTitleInput.focus();
            groupTitleInput.select();
        });

        groupTitleInput.addEventListener('blur', () => {
            const newTitle = groupTitleInput.value.trim() || 'Untitled Group';
            groupTitle.textContent = newTitle;
            groupTitle.classList.remove('hidden');
            groupTitleInput.classList.add('hidden');
            console.log('Title updated to:', newTitle);
        });

        groupTitleInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                groupTitleInput.blur();
            } else if (e.key === 'Escape') {
                groupTitleInput.value = groupTitle.textContent;
                groupTitleInput.blur();
            }
        });

        // AI Name Generation
        const aiNameBtn = document.getElementById('aiNameBtn');
        aiNameBtn.addEventListener('click', async () => {
            if (aiNameBtn.disabled) return;

            const startTime = performance.now();
            aiNameBtn.disabled = true;
            aiNameBtn.textContent = '⏳';

            // Simulate AI generation (500ms)
            await new Promise(resolve => setTimeout(resolve, 500));

            const generatedNames = [
                'Development Tools',
                'Coding Resources',
                'Web Development',
                'Programming Hub',
                'Dev Environment'
            ];

            const newName = generatedNames[Math.floor(Math.random() * generatedNames.length)];
            groupTitle.textContent = newName;
            groupTitleInput.value = newName;

            aiNameBtn.disabled = false;
            aiNameBtn.textContent = '✨';

            const endTime = performance.now();
            document.getElementById('aiNameTime').textContent = (endTime - startTime).toFixed(0);

            addToast(`Generated name: "${newName}"`, 'success');
            console.log('AI generated name:', newName);
        });

        // Delete Group
        const deleteBtn = document.getElementById('deleteBtn');
        deleteBtn.addEventListener('click', () => {
            if (confirm('Delete group "' + groupTitle.textContent + '"? Tabs will be ungrouped.')) {
                const startTime = performance.now();

                document.getElementById('testGroup').style.opacity = '0.5';
                document.getElementById('testGroup').style.transform = 'scale(0.95)';

                setTimeout(() => {
                    document.getElementById('testGroup').remove();

                    const endTime = performance.now();
                    document.getElementById('deleteTime').textContent = (endTime - startTime).toFixed(2);

                    addToast('Group deleted, tabs ungrouped', 'info');
                    console.log('Group deleted');
                }, 300);
            }
        });

        // Toast notifications
        function addToast(message, type = 'info') {
            const id = toastId++;
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.setAttribute('data-toast-id', id);
            toast.innerHTML = `<span>${message}</span>`;

            document.getElementById('toastContainer').appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        console.log('✓ Phase 4 mock interface loaded');
        console.log('  - Color picker: 8 Chrome colors');
        console.log('  - AI name generation with spinner');
        console.log('  - Delete with confirmation');
        console.log('  - Inline title editing');
    </script>
</body>
</html>
